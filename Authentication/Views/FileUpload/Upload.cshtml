@{
    ViewBag.Title = "Upload";
}

@*<script src="~/Scripts/jquery-1.11.1.min.js"></script>*@
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script>

    //$(function () {
    //    $("#Receivers").on("change", function {
    //        $("#Receivers").val($(this).text());
    //    });
    //});

    $(document).ready(function () {
        $('#btnUploadFile').on('click', function () {
            var data = new FormData();
            var receiver = $("#ddlReceivers option:selected").text();
            var privatekey = $("#privatekey").val();

            data.append("PrivateKey", privatekey);
            data.append("Reciever", receiver);

            var files = $("#fileUpload").get(0).files;
            // Add the uploaded image content to the form data collection
            if (files.length > 0) {
                data.append("UploadedImage", files[0]);                
            }

            // Make Ajax request with the contentType = false, and procesDate = false
            var ajaxRequest = $.ajax({
                type: "POST",
                url: "FileUpload/Index",
                contentType: false,
                processData: false,
                data: data
            });

            ajaxRequest.done(function (xhr, textStatus) {
                // Do other operation
            });
        });
    });

</script>

<div class="container">
    @Html.AntiForgeryToken()
    <div id="loginbox" style="margin-top:50px;" class="mainbox col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2">

        <div class="panel panel-info">
            <div class="panel-heading">
                <div class="panel-title">Digital Signature</div>
                <div style="float:right; font-size: 80%; position: relative; top:-10px">
                    @Html.ActionLink("View my Sent Files?", "Downloads")
                </div>
            </div>
            <div style="padding-top:30px" class="panel-body">
                <div style="display:none" id="login-alert" class="alert alert-danger col-sm-12"></div>

                <form id="loginform" class="form-horizontal" role="form">
                    @Html.AntiForgeryToken()
                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    <div style="margin-bottom: 25px" class="input-group">                        
                        <input type="file" name="FileUpload1" id="fileUpload" class="form-control" /><br />
                    </div>
                    <div style="margin-bottom: 25px" class="input-group">                        
                        @Html.DropDownList("ddlReceivers", ViewBag.OrgUsers as SelectList, "Select Reciever", new { id = "ddlReceivers", @class = "form-control" })
                    </div>
                    <div style="margin-bottom: 25px" class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
                        <input type="text" placeholder="Scan your Private Key" class="form-control" id="privatekey" />
                    </div>
                    <div style="margin-top:10px" class="form-group">
                        <!-- Button -->
                        <div class="col-sm-12 controls">
                            @*<a id="btn-login" href="#" class="btn btn-success">Login  </a>*@
                            <input type="submit" id="btnUploadFile" value="Sign and Send" class="btn btn-success" />

                        </div>
                    </div>
                    </form>
                </div>
            </div>
        </div>                                       
</div>

